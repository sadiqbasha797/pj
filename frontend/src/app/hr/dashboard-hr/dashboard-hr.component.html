<div class="dashboard-hr-container p-6 bg-gradient-to-br from-blue-50 via-white to-indigo-100 min-h-screen">
  <div *ngIf="loading" class="flex justify-center items-center h-64">
    <mat-spinner color="primary" diameter="64"></mat-spinner>
  </div>
  <div *ngIf="!loading">
    <div *ngIf="error" class="bg-red-100 text-red-700 p-4 rounded mb-4 text-center animate-pulse">{{ error }}</div>
    <!-- Stat Cards -->
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-6 mb-10">
      <!-- Developers Card -->
      <div class="bg-white rounded-2xl shadow-lg p-5 flex flex-col items-center justify-between h-44 group transition-transform duration-300 hover:-translate-y-1 hover:shadow-2xl border-t-4 border-blue-500">
        <div class="flex items-center justify-center w-12 h-12 rounded-full bg-blue-100 mb-2 group-hover:bg-blue-200 transition">
          <mat-icon class="text-blue-600 text-2xl leading-none !m-0 p-0">groups</mat-icon>
        </div>
        <div class="text-3xl font-extrabold text-blue-700 mb-1">{{ totalDevelopers }}</div>
        <div class="text-sm font-medium text-blue-500 tracking-wide">Developers</div>
      </div>
      <!-- Marketers Card -->
      <div class="bg-white rounded-2xl shadow-lg p-5 flex flex-col items-center justify-between h-44 group transition-transform duration-300 hover:-translate-y-1 hover:shadow-2xl border-t-4 border-green-500">
        <div class="flex items-center justify-center w-12 h-12 rounded-full bg-green-100 mb-2 group-hover:bg-green-200 transition">
          <mat-icon class="text-green-600 text-2xl leading-none !m-0 p-0">campaign</mat-icon>
        </div>
        <div class="text-3xl font-extrabold text-green-700 mb-1">{{ totalMarketers }}</div>
        <div class="text-sm font-medium text-green-500 tracking-wide">Marketers</div>
      </div>
      <!-- Content Creators Card -->
      <div class="bg-white rounded-2xl shadow-lg p-5 flex flex-col items-center justify-between h-44 group transition-transform duration-300 hover:-translate-y-1 hover:shadow-2xl border-t-4 border-yellow-400">
        <div class="flex items-center justify-center w-12 h-12 rounded-full bg-yellow-100 mb-2 group-hover:bg-yellow-200 transition">
          <mat-icon class="text-yellow-500 text-2xl leading-none !m-0 p-0">edit</mat-icon>
        </div>
        <div class="text-3xl font-extrabold text-yellow-600 mb-1">{{ totalContentCreators }}</div>
        <div class="text-sm font-medium text-yellow-500 tracking-wide">Content Creators</div>
      </div>
      <!-- Payslips Card -->
      <div class="bg-white rounded-2xl shadow-lg p-5 flex flex-col items-center justify-between h-44 group transition-transform duration-300 hover:-translate-y-1 hover:shadow-2xl border-t-4 border-indigo-500">
        <div class="flex items-center justify-center w-12 h-12 rounded-full bg-indigo-100 mb-2 group-hover:bg-indigo-200 transition">
          <mat-icon class="text-indigo-600 text-2xl leading-none !m-0 p-0">receipt_long</mat-icon>
        </div>
        <div class="text-3xl font-extrabold text-indigo-700 mb-1">{{ totalPayslips }}</div>
        <div class="text-sm font-medium text-indigo-500 tracking-wide">Payslips</div>
      </div>
      <!-- Leaves Card -->
      <div class="bg-white rounded-2xl shadow-lg p-5 flex flex-col items-center justify-between h-44 group transition-transform duration-300 hover:-translate-y-1 hover:shadow-2xl border-t-4 border-orange-400">
        <div class="flex items-center justify-center w-12 h-12 rounded-full bg-orange-100 mb-2 group-hover:bg-orange-200 transition">
          <mat-icon class="text-orange-500 text-2xl leading-none !m-0 p-0">event_available</mat-icon>
        </div>
        <div class="text-3xl font-extrabold text-orange-600 mb-1">{{ totalLeaves }}</div>
        <div class="text-sm font-medium text-orange-500 tracking-wide">Leaves</div>
      </div>
      <!-- Pending Team Requests Card -->
      <div class="bg-white rounded-2xl shadow-lg p-5 flex flex-col items-center justify-between h-44 group transition-transform duration-300 hover:-translate-y-1 hover:shadow-2xl border-t-4 border-pink-500">
        <div class="flex items-center justify-center w-12 h-12 rounded-full bg-pink-100 mb-2 group-hover:bg-pink-200 transition">
          <mat-icon class="text-pink-600 text-2xl leading-none !m-0 p-0">group_add</mat-icon>
        </div>
        <div class="text-3xl font-extrabold text-pink-700 mb-1">{{ pendingTeamRequests }}</div>
        <div class="text-sm font-medium text-pink-500 tracking-wide">Pending Team Requests</div>
      </div>
    </div>
    <!-- Section Divider -->
    <div class="flex items-center mb-6">
      <mat-icon class="text-blue-600 mr-2">insights</mat-icon>
      <h2 class="text-xl font-bold text-blue-900 tracking-wide">Analytics</h2>
      <div class="flex-1 border-b border-blue-200 ml-4"></div>
    </div>
    <!-- Charts -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
      <div class="bg-white shadow-lg rounded-xl p-6 flex flex-col items-center animate-fade-in">
        <div class="font-semibold mb-2 text-blue-700 flex items-center"><mat-icon class="mr-1">pie_chart</mat-icon>Employee Roles</div>
        <canvas baseChart
          [data]="employeeRoleChartData"
          [type]="'pie'"
          [options]="{ responsive: true, plugins: { legend: { position: 'bottom' } } }"
          class="w-full h-64 animate-fade-in"></canvas>
      </div>
      <div class="bg-white shadow-lg rounded-xl p-6 flex flex-col items-center animate-fade-in">
        <div class="font-semibold mb-2 text-indigo-700 flex items-center"><mat-icon class="mr-1">bar_chart</mat-icon>Payslips by Role</div>
        <div style="height: 260px; width: 100%;">
          <canvas baseChart
            [data]="payslipStatsChartData"
            [type]="'bar'"
            [options]="payslipStatsChartOptions"
            class="w-full h-full animate-fade-in"></canvas>
        </div>
      </div>
      <div class="bg-white shadow-lg rounded-xl p-6 flex flex-col items-center animate-fade-in">
        <div class="font-semibold mb-2 text-orange-700 flex items-center"><mat-icon class="mr-1">donut_large</mat-icon>Leave Status</div>
        <canvas baseChart
          [data]="leaveStatusChartData"
          [type]="'doughnut'"
          [options]="{ responsive: true, plugins: { legend: { position: 'bottom' } } }"
          class="w-full h-64 animate-fade-in"></canvas>
      </div>
    </div>
    <!-- Section Divider -->
    <div class="flex items-center mb-6 mt-10">
      <mat-icon class="text-green-600 mr-2">history</mat-icon>
      <h2 class="text-xl font-bold text-green-900 tracking-wide">Recent Activity</h2>
      <div class="flex-1 border-b border-green-200 ml-4"></div>
    </div>
    <!-- Recent Activity Tables -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <div class="bg-white shadow-lg rounded-xl p-6 animate-fade-in">
        <div class="font-semibold mb-4 text-indigo-700 flex items-center text-lg"><mat-icon class="mr-1">receipt_long</mat-icon>Recent Payslips</div>
        <div class="overflow-x-auto">
          <table class="min-w-full text-sm rounded-xl overflow-hidden">
            <thead>
              <tr class="bg-indigo-100 text-indigo-800 text-base font-bold border-b border-indigo-200">
                <th class="py-3 px-4 text-left">Employee</th>
                <th class="py-3 px-4 text-left">Amount</th>
                <th class="py-3 px-4 text-left">Date</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let p of recentPayslips; let i = index" [ngClass]="i % 2 === 0 ? 'bg-white' : 'bg-indigo-50'" class="border-b border-indigo-100 hover:bg-indigo-200/60 transition duration-200">
                <td class="py-3 px-4 font-medium flex items-center gap-2"><mat-icon class="text-blue-500">person</mat-icon>{{ p.paidTo?.name }}</td>
                <td class="py-3 px-4 font-semibold text-indigo-900">{{ p.amount | currency }}</td>
                <td class="py-3 px-4 text-indigo-700">{{ p.paidDate | date:'shortDate' }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="bg-white shadow-lg rounded-xl p-6 animate-fade-in">
        <div class="font-semibold mb-4 text-orange-700 flex items-center text-lg"><mat-icon class="mr-1">event_note</mat-icon>Recent Leave Requests</div>
        <div class="overflow-x-auto">
          <table class="min-w-full text-sm rounded-xl overflow-hidden">
            <thead>
              <tr class="bg-orange-100 text-orange-800 text-base font-bold border-b border-orange-200">
                <th class="py-3 px-4 text-left">Employee</th>
                <th class="py-3 px-4 text-left">From</th>
                <th class="py-3 px-4 text-left">To</th>
                <th class="py-3 px-4 text-left">Status</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let l of recentLeaves; let i = index" [ngClass]="i % 2 === 0 ? 'bg-white' : 'bg-orange-50'" class="border-b border-orange-100 hover:bg-orange-200/60 transition duration-200">
                <td class="py-3 px-4 font-medium flex items-center gap-2"><mat-icon class="text-orange-500">person</mat-icon>{{ l.developerName }}</td>
                <td class="py-3 px-4">{{ l.startDate | date:'shortDate' }}</td>
                <td class="py-3 px-4">{{ l.endDate | date:'shortDate' }}</td>
                <td class="py-3 px-4">
                  <span [ngClass]="{
                    'bg-orange-200 text-orange-900 font-semibold px-3 py-1 rounded-full shadow-sm': l.status === 'Pending',
                    'bg-green-200 text-green-900 font-semibold px-3 py-1 rounded-full shadow-sm': l.status === 'Approved',
                    'bg-red-200 text-red-900 font-semibold px-3 py-1 rounded-full shadow-sm': l.status === 'Denied'
                  }">{{ l.status }}</span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="bg-white shadow-lg rounded-xl p-6 animate-fade-in">
        <div class="font-semibold mb-4 text-pink-700 flex items-center text-lg"><mat-icon class="mr-1">group_add</mat-icon>Recent Team Requests</div>
        <div class="overflow-x-auto">
          <table class="min-w-full text-sm rounded-xl overflow-hidden">
            <thead>
              <tr class="bg-pink-100 text-pink-800 text-base font-bold border-b border-pink-200">
                <th class="py-3 px-4 text-left">Manager</th>
                <th class="py-3 px-4 text-left">Member</th>
                <th class="py-3 px-4 text-left">Type</th>
                <th class="py-3 px-4 text-left">Status</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let r of recentTeamRequests; let i = index" [ngClass]="i % 2 === 0 ? 'bg-white' : 'bg-pink-50'" class="border-b border-pink-100 hover:bg-pink-200/60 transition duration-200">
                <td class="py-3 px-4 font-medium flex items-center gap-2"><mat-icon class="text-pink-500">person</mat-icon>{{ r.manager?.username }}</td>
                <td class="py-3 px-4 font-medium flex items-center gap-2"><mat-icon class="text-pink-400">person</mat-icon>{{ r.memberId?.username }}</td>
                <td class="py-3 px-4">{{ r.requestType }}</td>
                <td class="py-3 px-4">
                  <span [ngClass]="{
                    'bg-pink-200 text-pink-900 font-semibold px-3 py-1 rounded-full shadow-sm': r.status === 'pending',
                    'bg-green-200 text-green-900 font-semibold px-3 py-1 rounded-full shadow-sm': r.status === 'approved',
                    'bg-gray-200 text-gray-900 font-semibold px-3 py-1 rounded-full shadow-sm': r.status !== 'pending' && r.status !== 'approved'
                  }">{{ r.status }}</span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
@keyframes fade-in {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}
.animate-fade-in {
  animation: fade-in 0.8s cubic-bezier(0.4,0,0.2,1) both;
}
/* Hide scrollbars for table containers */
.overflow-x-auto {
  scrollbar-width: none; /* Firefox */
  -ms-overflow-style: none;  /* IE and Edge */
}
.overflow-x-auto::-webkit-scrollbar {
  display: none; /* Chrome, Safari, Opera */
}
</style>
